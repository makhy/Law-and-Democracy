---
title: "Hw5-Analysis"
author: "Hy Mak"
date: "4/26/2018"
output: html_document
---

# Download necessary libaries

```{r setup, message=FALSE}
library(tidyverse)
```

# Import Rule of Law and Democracy Data

```{r}

# Tidy the data

(democracy <- read_csv("uds_summary.csv",
                       col_types = cols(year = col_number())) %>%
    filter(country %in% c("Malaysia", 
                      "Singapore", 
                      "Zambia", 
                      "Ghana", 
                      "Sierra Leone", 
                      "Laos", 
                      "Cambodia", 
                      "Morocco", 
                      "Algeria", 
                      "Tunisia")) %>%
   select(country, year, mean) %>%
   rename(Year = "year",
          Country = "country",
          Demo_Score = "mean"))

(law <- read_csv("Rule_of_law_WB.csv",
                       col_types = cols(Year = col_number())) %>%
    rename(ROL_Estimate = "Rule of Law: Estimate [RL.EST]",
           ROL_Percentile = "Rule of Law: Percentile Rank [RL.PER.RNK]",
           Year = "Time",
           Country = "Country Name") %>%
    select(Year, 
           Country, 
           ROL_Estimate, 
           ROL_Percentile) %>%
    mutate(Country = ifelse(Country == "Lao PDR", 'Laos', Country)) %>%
    mutate(Year = as.numeric(Year)))

(demo_law <- democracy %>%
    left_join(law, by = c("Year", "Country"))
)


```


```{r, message = FALSE}
demo_law %>%
  ggplot(aes(Demo_Score, 
        ROL_Estimate), na.rm = TRUE) +
  geom_point(aes(shape = Country, color = Country)) +
  geom_smooth() +
  theme_minimal(base_size = 10) +
  labs(x = "Democracy Levels",
       y = "Rule of Law Score",
       title = "Democracy and Rule of Law Relationship")
  
```


```{r}

demo_law %>%
  ggplot(aes(x = Country,
             y = Demo_Score)) +
  geom_boxplot(aes(color = Country)) +
  theme_minimal(base_size = 10) +
  theme(legend.position="none",
        legend.key.size = unit(0.25, "cm"),
        legend.title = element_blank(),
        axis.text.x = 
            element_text(angle=90, hjust=1)) +
  labs(x = NULL,
       y = "Democracy Scores",
       title = "Democracy Levels (1956 - 2016)")

```

```{r}
British <- demo_law %>%
  filter(Country %in% c("Malaysia",
                        "Singapore",
                         "Ghana",
                        "Zambia",
                        "Sierra Leone"))

French <- demo_law %>%
  filter(Country %in% c ("Cambodia",
                         "Laos",
                         "Algeria",
                         "Morocco",
                         "Tunisia"))

ggplot() +
  geom_smooth(data = British, 
              mapping = aes(Demo_Score, ROL_Estimate), 
              color = "red") +
  geom_smooth(data = French,
              mapping = aes(Demo_Score, ROL_Estimate),
              color = "blue")
  



```


